<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="http://cdn.staticfile.org/meyer-reset/2.0/reset.min.css">
    <link rel="stylesheet" href="http://cdn.staticfile.org/fancybox/2.1.4/jquery.fancybox.min.css">
    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Dosis'>
    <link rel='stylesheet' href='/static/site.css'>
</head>
<body>
    <nav>
        <ul>
            <li><a href="/archive">Archive</a></li>
            <!-- <li><a href="#">About</a></li> -->
        </ul>
        <p id="logo"><a href="/">MFA DIGEST</a></p>
    </nav>
    <div id="main">
        {% block content %}{% endblock %}
    </div>
    <script src="http://cdn.staticfile.org/jquery/2.0.3/jquery.js"></script>
    <script src="http://cdn.staticfile.org/imagesloaded/3.0.4/imagesloaded.pkgd.js"></script>
    <script src="http://cdn.staticfile.org/jquery.wookmark/1.3.1/jquery.wookmark.min.js"></script>
    <script src="http://cdn.staticfile.org/fancybox/2.1.4/jquery.fancybox.min.js"></script>
    <script>
        (function () {
            $('#tiles').imagesLoaded(function () {
                var handler = null;

                // Prepare layout options.
                var options = {
                    autoResize: true, // This will auto-update the layout when the browser window is resized.
                    container: $('#main'), // Optional, used for some extra CSS styling
                    offset: 15, // Optional, the distance between grid items
                    itemWidth: 320 // Optional, the width of a grid item
                };

                function applyLayout() {
                    $('#tiles').imagesLoaded(function () {
                        // Destroy the old handler
                        if (handler.wookmarkInstance) {
                            handler.wookmarkInstance.clear();
                        }

                        // Create a new layout handler.
                        handler = $('#tiles li');
                        handler.wookmark(options);
                    });
                }

                /**
                 * When scrolled all the way to the bottom, add more tiles.
                 */
                function onScroll(event) {
                    // Check if we're within 100 pixels of the bottom edge of the broser window.
                    var winHeight = window.innerHeight ? window.innerHeight : $(window).height(); // iphone fix
                    var closeToBottom = ($(window).scrollTop() + winHeight > $(document).height() - 100);

                    if (closeToBottom) {
                        // Get the first then items from the grid, clone them, and add them to the bottom of the grid.
                        var items = $('#tiles li'),
                                firstTen = items.slice(0, 10);
                        $('#tiles').append(firstTen.clone());

                        applyLayout();
                    }
                };

                // Capture scroll event.
                $(window).bind('scroll', onScroll);

                // Call the layout function.
                handler = $('#tiles li');
                handler.wookmark(options);
            });

            //fancybox
            $(".img").fancybox({
                type: "image",
                padding: 20,
                closeBtn: false,
                openEffect: 'fade',
                closeEffect: 'elastic',

                helpers: {
                    title: {
                        type: 'inside'
                    },
                    overlay: {
                        css: {
                            'background': 'rgba(24,27,32,0.8)'
                        }
                    }
                },

                beforeLoad: function () {
                    this.title = $(this.element).parent().find(".detail").html();
                }
            });
        })();
    </script>
</body>
</html>